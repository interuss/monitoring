# ===== NetRID =====

netrid_observation_evaluation_configuration:
  $content_schema: monitoring/uss_qualifier/resources/definitions/ResourceDeclaration.json
  resource_type: resources.netrid.EvaluationConfigurationResource
  specification: { }

id_generator:
  $content_schema: monitoring/uss_qualifier/resources/definitions/ResourceDeclaration.json
  resource_type: resources.interuss.IDGeneratorResource
  dependencies:
    auth_adapter: utm_auth
  specification:
    whoami_audience: localhost
    whoami_scope: rid.display_provider

kentland_service_area:
  $content_schema: monitoring/uss_qualifier/resources/definitions/ResourceDeclaration.json
  resource_type: resources.netrid.ServiceAreaResource
  specification:
    base_url: https://uss_qualifier.test.utm/dummy_base_url
    footprint:
      - lat: 37.1853
        lng: -80.6140
      - lat: 37.2148
        lng: -80.6140
      - lat: 37.2148
        lng: -80.5440
      - lat: 37.1853
        lng: -80.5440
    altitude_min: 0
    altitude_max: 3048
    reference_time: '2023-01-10T00:00:00.123456+00:00'
    time_start: '2023-01-10T00:00:01.123456+00:00'
    time_end: '2023-01-10T01:00:01.123456+00:00'

au_problematically_big_area: # A huge (as in "too big") area for checks around area sizes
  $content_schema: monitoring/uss_qualifier/resources/definitions/ResourceDeclaration.json
  resource_type: resources.VerticesResource
  specification:
    vertices:
      - lat: -23
        lng: 130
      - lat: -24
        lng: 130
      - lat: -24
        lng: 132
      - lat: -23
        lng: 132

kentland_problematically_big_area:
  resource_type: resources.VerticesResource
  specification:
    vertices:
      - lat: 38
        lng: -81
      - lat: 37
        lng: -81
      - lat: 37
        lng: -80
      - lat: 38
        lng: -80

# ===== NetRID flights data =====

che_adjacent_circular_flights_data:
  $content_schema: monitoring/uss_qualifier/resources/definitions/ResourceDeclaration.json
  resource_type: resources.netrid.FlightDataResource
  specification:
    adjacent_circular_flights_simulation_source: { }

dc_flights_data:
  $content_schema: monitoring/uss_qualifier/resources/definitions/ResourceDeclaration.json
  resource_type: resources.netrid.FlightDataResource
  specification:
    kml_source:
      kml_file:
        path: file://./test_data/usa/netrid/dcdemo.kml

kentland_flights_data:
  $content_schema: monitoring/uss_qualifier/resources/definitions/ResourceDeclaration.json
  resource_type: resources.netrid.FlightDataResource
  specification:
    kml_source:
      kml_file:
        path: file://./test_data/usa/kentland/rid.kml
    flight_start_delay: 5s

foca_flights_data:
  $content_schema: monitoring/uss_qualifier/resources/definitions/ResourceDeclaration.json
  resource_type: resources.netrid.FlightDataResource
  specification:
    kml_source:
      kml_file:
        path: file://./test_data/che/rid/foca.kml
    flight_start_delay: 5s

# ===== NetRID data generation/simulation/storage =====

adjacent_circular_storage_config:
  $content_schema: monitoring/uss_qualifier/resources/definitions/ResourceDeclaration.json
  resource_type: resources.netrid.FlightDataStorageResource
  specification:
    flight_record_collection_path: "./output/generate_rid_test_data/flight_data/test_data.che.netrid.circular_flights.json"

kml_storage_config:
  $content_schema: monitoring/uss_qualifier/resources/definitions/ResourceDeclaration.json
  resource_type: resources.netrid.FlightDataStorageResource
  specification:
    flight_record_collection_path: "./output/generate_rid_test_data/flight_data/test_data.usa.netrid.dcdemo_flights.json"

# ===== Flight planning intents =====

che_invalid_flight_auth_flights:
  $content_schema: monitoring/uss_qualifier/resources/definitions/ResourceDeclaration.json
  resource_type: resources.flight_planning.FlightIntentsResource
  specification:
    planning_time: '0:05:00'
    file:
      path: file://./test_data/che/flight_intents/invalid_flight_auths.yaml

che_conflicting_flights:
  # Includes flight intents for both equal-priority-not-permitted and higher-priority
  $content_schema: monitoring/uss_qualifier/resources/definitions/ResourceDeclaration.json
  resource_type: resources.flight_planning.FlightIntentsResource
  specification:
    planning_time: '0:05:00'
    file:
      path: file://./test_data/che/flight_intents/conflicting_flights.yaml
      # Note that this hash_sha512 field can be safely deleted if the content changes
      hash_sha512: 86b7172de3a6029efdb5c39dff00f96578f81d25b65b4a0a9d731a42a1e260ef632a0891b744b6d1f62fd7bec61cdad3cb8e6b6811a16cbc17ec2dbd081cbbf6

che_invalid_flight_intents:
  $content_schema: monitoring/uss_qualifier/resources/definitions/ResourceDeclaration.json
  resource_type: resources.flight_planning.FlightIntentsResource
  specification:
    planning_time: '0:05:00'
    file:
      path: test_data.che.flight_intents.invalid_flight_intents

# ===== General flight authorization =====

example_flight_check_table:
  $content_schema: monitoring/uss_qualifier/resources/definitions/ResourceDeclaration.json
  resource_type: resources.interuss.flight_authorization.FlightCheckTableResource
  specification:
    table:
      rows:
        - flight_check_id: TEST_001
          requirement_ids:
            - REQ_002
            - REQ_007
          description: The first test step defined by the test designer
          acceptance_expectation: MustBeAccepted
          flight_info:
            basic_information:
              usage_state: Planned
              uas_state: Nominal
              area:
                - outline_circle:
                    center:
                      lng: 7.4774
                      lat: 46.9749
                    radius:
                      value: 100
                      units: M
                  altitude_lower:
                    value: 550
                    units: M
                    # TODO: Change to SFC once mock_uss can process that datum
                    reference: W84
                  altitude_upper:
                    value: 650
                    units: M
                    # TODO: Change to SFC once mock_uss can process that datum
                    reference: W84
                  start_time:
                    start_of_test: { }
                    use_timezone: Europe/Berlin
                  end_time:
                    offset_from:
                      starting_from:
                        next_day:
                          time_zone: Europe/Zurich
                          starting_from:
                            start_of_test: { }
                          days_of_the_week: [ "Tu", "Th" ]
                      offset: 12h
            additional_information:
              new_jurisdiction_x:
                operation_rule_set: Rules1
            # TODO: Remove once mock_uss is fixed to not require U-space flight auth
            uspace_flight_authorisation:
              uas_serial_number: 1AF49UL5CC5J6K
              operation_category: Open
              operation_mode: Vlos
              uas_class: C0
              identification_technologies:
                - ASTMNetRID
              connectivity_methods:
                - cellular
              endurance_minutes: 30
              emergency_procedure_url: https://example.interussplatform.org/emergency
              operator_id: CHEo5kut30e0mt01-qwe
              uas_id: ''
              uas_type_certificate: ''
        - flight_check_id: TEST_002
          requirement_ids:
            - REQ_001
            - REQ_003
            - REQ_004
          description: The second test step defined by the test designer
          acceptance_expectation: MustBeAccepted
          flight_info:
            basic_information:
              usage_state: Planned
              uas_state: Nominal
              area:
                - outline_circle:
                    center:
                      lng: 7.4774
                      lat: 46.9749
                    radius:
                      value: 100
                      units: M
                  altitude_lower:
                    value: 1424
                    units: M
                    reference: W84
                  altitude_upper:
                    value: 5000
                    units: FT
                    reference: W84
                  start_time:
                    next_day:
                      time_zone: +02:00
                      starting_from:
                        offset_from:
                          starting_from:
                            start_of_test: { }
                          offset: 12h
                  duration: 5m
            additional_information:
              new_jurisdiction_x:
                operation_rule_set: Rules1
            # TODO: Remove once mock_uss is fixed to not require U-space flight auth
            uspace_flight_authorisation:
              uas_serial_number: 1AF49UL5CC5J6K
              operation_category: Open
              operation_mode: Vlos
              uas_class: C0
              identification_technologies:
                - ASTMNetRID
              connectivity_methods:
                - cellular
              endurance_minutes: 30
              emergency_procedure_url: https://example.interussplatform.org/emergency
              operator_id: CHEo5kut30e0mt01-qwe
              uas_id: ''
              uas_type_certificate: ''

# ===== Geospatial feature comprehension =====

example_feature_check_table:
  $content_schema: monitoring/uss_qualifier/resources/definitions/ResourceDeclaration.json
  resource_type: resources.interuss.geospatial_map.FeatureCheckTableResource
  specification:
    table:
      rows:
        - geospatial_check_id: TEST_001
          requirement_ids:
            - REQ_002
            - REQ_007
          description: The first test step defined by the test designer
          operation_rule_set: Rules1
          restriction_source: ThisRegulator
          volumes:
            - outline_circle:
                center:
                  lng: 7.4774
                  lat: 46.9749
                radius:
                  value: 100
                  units: M
              altitude_lower:
                value: 0
                units: M
                reference: SFC
              altitude_upper:
                value: 100
                units: M
                reference: SFC
              start_time:
                start_of_test: { }
              end_time:
                offset_from:
                  starting_from:
                    next_day:
                      time_zone: Europe/Zurich
                      starting_from:
                        start_of_test: { }
                      days_of_the_week: [ "Mo", "Fr" ]
                  offset: 12h
          expected_result: Block
        - geospatial_check_id: TEST_002
          requirement_ids:
            - REQ_001
            - REQ_003
            - REQ_004
          description: The second test step defined by the test designer
          operation_rule_set: Rules1
          restriction_source: ThisRegulator
          volumes:
            - outline_circle:
                center:
                  lng: 7.4774
                  lat: 46.9749
                radius:
                  value: 100
                  units: M
              altitude_lower:
                value: 50
                units: M
                reference: SFC
              altitude_upper:
                value: 5000
                units: FT
                reference: W84
              start_time:
                next_day:
                  time_zone: Europe/Zurich
                  starting_from:
                    offset_from:
                      starting_from:
                        start_of_test: { }
                      offset: 12h
                use_timezone: +01:00
              duration: 5m
          expected_result: Advise
        - geospatial_check_id: TEST_002
          requirement_ids:
            - REQ_001
            - REQ_003
            - REQ_004
          description: The second test step defined by the test designer
          operation_rule_set: Rules1
          restriction_source: ThisRegulator
          volumes:
            - outline_circle:
                center:
                  lng: 7.4774
                  lat: 46.9749
                radius:
                  value: 100
                  units: M
              altitude_upper:
                value: 400
                units: FT
                reference: SFC
              end_time:
                next_sun_position:
                  elevation_deg: -0.833  # Sunset
                  observed_from:
                    lng: 7.4774
                    lat: 46.9749
                  starting_from:
                    offset_from:
                      starting_from:
                        next_day:
                          time_zone: Europe/Zurich
                          starting_from:
                            start_of_test: { }
                      offset: 12h
              duration: 5m
          expected_result: Advise

# ===== mock_uss behavioral control =====

locality_che:
  $content_schema: monitoring/uss_qualifier/resources/definitions/ResourceDeclaration.json
  resource_type: resources.interuss.mock_uss.locality.LocalityResource
  specification:
    locality_code: CHE
